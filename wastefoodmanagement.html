<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Food Waste Tracker</title>
    <style>
       
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        :root {
            --primary-green: #2E7D32;
            --light-green: #4CAF50;
            --accent-orange: #FF9800;
            --accent-saffron: #FF9933;
            --background: #F5F5F5;
            --card-bg: #FFFFFF;
            --text-dark: #333333;
            --text-light: #666666;
            --border: #E0E0E0;
        }

        body {
            background-color: var(--background);
            color: var(--text-dark);
            min-height: 100vh;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header Styles */
        .header {
            background: linear-gradient(135deg, var(--primary-green), var(--light-green));
            color: white;
            padding: 1.5rem;
            border-radius: 10px;
            margin-bottom: 2rem;
            text-align: center;
            box-shadow: 0 4px 12px rgba(46, 125, 50, 0.2);
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: "ðŸ‡®ðŸ‡³";
            position: absolute;
            top: 10px;
            right: 20px;
            font-size: 2rem;
            opacity: 0.3;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        .header p {
            opacity: 0.9;
            font-size: 1.1rem;
        }

        /* Card Styles */
        .card {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 1.5rem;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.08);
            border: 1px solid var(--border);
            transition: transform 0.3s ease;
            margin-bottom: 20px;
        }

        .card:hover {
            transform: translateY(-5px);
        }

        .card-title {
            font-size: 1.5rem;
            color: var(--primary-green);
            margin-bottom: 1.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--border);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .card-title i {
            font-size: 1.2rem;
        }

        /* Indian Rupee Symbol */
        .rupee {
            font-family: Arial, sans-serif;
            font-weight: bold;
        }

        /* Form Styles */
        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--text-dark);
            font-size: 0.95rem;
        }

        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--light-green);
        }

        .input-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        /* Button Styles */
        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(to right, var(--primary-green), var(--light-green));
            color: white;
        }

        .btn-primary:hover {
            background: linear-gradient(to right, #1B5E20, #388E3C);
            box-shadow: 0 4px 15px rgba(76, 175, 80, 0.3);
        }

        .btn-secondary {
            background: var(--accent-saffron);
            color: white;
        }

        .btn-secondary:hover {
            background: #E67E22;
            box-shadow: 0 4px 15px rgba(255, 152, 0, 0.3);
        }

        .btn-full {
            width: 100%;
            padding: 15px;
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 1.5rem;
        }

        .stat-card {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            padding: 1rem;
            border-radius: 10px;
            text-align: center;
            border: 1px solid var(--border);
        }

        .stat-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--primary-green);
            margin-bottom: 0.5rem;
        }

        .stat-label {
            font-size: 0.9rem;
            color: var(--text-light);
            font-weight: 500;
        }

        /* Indian Food Categories */
        .food-category-tag {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 500;
            margin: 2px;
        }

        .veg { background: #E8F5E9; color: #2E7D32; border: 1px solid #C8E6C9; }
        .non-veg { background: #FFEBEE; color: #C62828; border: 1px solid #FFCDD2; }
        .sweets { background: #FFF3E0; color: #EF6C00; border: 1px solid #FFE0B2; }
        .snacks { background: #FFF8E1; color: #F9A825; border: 1px solid #FFECB3; }

        /* Table Styles */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
        }

        .data-table th {
            background: #f8f9fa;
            padding: 12px 15px;
            text-align: left;
            font-weight: 600;
            color: var(--text-dark);
            border-bottom: 2px solid var(--border);
        }

        .data-table td {
            padding: 12px 15px;
            border-bottom: 1px solid var(--border);
        }

        .data-table tr:hover {
            background: #f8f9fa;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: white;
            padding: 2rem;
            border-radius: 15px;
            width: 90%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .modal-title {
            font-size: 1.5rem;
            color: var(--primary-green);
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text-light);
        }

        /* Screen Navigation */
        .screen {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .screen.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Navigation */
        .nav-bar {
            background: white;
            padding: 1rem;
            border-radius: 10px;
            margin-bottom: 2rem;
            display: flex;
            gap: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.08);
        }

        .nav-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            background: #f8f9fa;
            color: var(--text-dark);
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .nav-btn.active {
            background: var(--primary-green);
            color: white;
        }

        .nav-btn:hover:not(.active) {
            background: #e9ecef;
        }

        /* Indian Flag Colors */
        .flag-colors {
            display: flex;
            height: 4px;
            border-radius: 2px;
            overflow: hidden;
            margin: 10px 0;
        }

        .saffron { background: #FF9933; flex: 1; }
        .white { background: #FFFFFF; flex: 1; border-left: 1px solid #E0E0E0; border-right: 1px solid #E0E0E0; }
        .green { background: #138808; flex: 1; }

        /* Progress Bar */
        .progress-bar {
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            overflow: hidden;
            margin: 1rem 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(to right, var(--light-green), var(--primary-green));
            border-radius: 4px;
            transition: width 0.5s ease;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .nav-bar {
                flex-direction: column;
            }
            
            .nav-btn {
                width: 100%;
                justify-content: center;
            }
            
            .input-group {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 576px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2rem;
            }
        }
        /* =============== CSS END =============== */
    </style>
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <!-- =============== HTML CONTENT START =============== -->
        <div class="header">
            <div class="flag-colors">
                <div class="saffron"></div>
                <div class="white"></div>
                <div class="green"></div>
            </div>
            <h1><i class="fas fa-recycle"></i> Food Waste Tracker</h1>
            <p>Save Food, Save Money, Save India ðŸ‡®ðŸ‡³</p>
        </div>

        <!-- Navigation Bar -->
        <div class="nav-bar">
            <button class="nav-btn active" onclick="showScreen('login-screen')">
                <i class="fas fa-sign-in-alt"></i> Login
            </button>
            <button class="nav-btn" onclick="showScreen('food-entry-screen')">
                <i class="fas fa-utensils"></i> Food Entry
            </button>
            <button class="nav-btn" onclick="showScreen('dashboard-screen')">
                <i class="fas fa-chart-bar"></i> Dashboard
            </button>
        </div>

        <!-- Login Screen -->
        <div id="login-screen" class="screen active">
            <div class="card">
                <h2 class="card-title"><i class="fas fa-user-circle"></i> Login to Food Waste Tracker</h2>
                <form id="loginForm">
                    <div class="form-group">
                        <label class="form-label">Email Address</label>
                        <input type="email" id="loginEmail" class="form-control" placeholder="Enter your email" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Password</label>
                        <input type="password" id="loginPassword" class="form-control" placeholder="Enter your password" required>
                    </div>
                    
                    <div class="form-group">
                        <button type="submit" class="btn btn-primary btn-full">
                            <i class="fas fa-sign-in-alt"></i> Login
                        </button>
                    </div>
                    
                    <div style="text-align: center; margin-top: 1rem;">
                        <p style="color: var(--text-light);">Don't have an account? <a href="#" onclick="showRegisterModal()" style="color: var(--primary-green); font-weight: 600;">Register here</a></p>
                    </div>
                </form>
            </div>
            
            <div class="card">
                <h2 class="card-title"><i class="fas fa-info-circle"></i> How It Works</h2>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                    <div style="text-align: center;">
                        <div style="width: 60px; height: 60px; background: #E8F5E9; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 10px;">
                            <i class="fas fa-utensils" style="color: var(--primary-green); font-size: 1.5rem;"></i>
                        </div>
                        <h4 style="margin-bottom: 5px;">Track Food</h4>
                        <p style="color: var(--text-light); font-size: 0.9rem;">Record Indian meals you prepare & consume</p>
                    </div>
                    
                    <div style="text-align: center;">
                        <div style="width: 60px; height: 60px; background: #FFF3E0; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 10px;">
                            <i class="fas fa-rupee-sign" style="color: var(--accent-saffron); font-size: 1.5rem;"></i>
                        </div>
                        <h4 style="margin-bottom: 5px;">Save Money</h4>
                        <p style="color: var(--text-light); font-size: 0.9rem;">Reduce costs in Indian Rupees</p>
                    </div>
                    
                    <div style="text-align: center;">
                        <div style="width: 60px; height: 60px; background: #E3F2FD; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 10px;">
                            <i class="fas fa-leaf" style="color: #138808; font-size: 1.5rem;"></i>
                        </div>
                        <h4 style="margin-bottom: 5px;">Sustainable India</h4>
                        <p style="color: var(--text-light); font-size: 0.9rem;">Contribute to India's sustainability</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Food Entry Screen -->
        <div id="food-entry-screen" class="screen">
            <div class="card">
                <h2 class="card-title"><i class="fas fa-plus-circle"></i> Food Entry</h2>
                <form id="foodEntryForm">
                    <div class="form-group">
                        <label class="form-label">Food Item Name</label>
                        <input type="text" id="foodName" class="form-control" placeholder="e.g., Biryani, Roti, Sabji, Dal" required>
                    </div>
                    
                    <div class="input-group">
                        <div class="form-group">
                            <label class="form-label">Food Type</label>
                            <select id="foodType" class="form-control" required>
                                <option value="">Select Food Type</option>
                                <option value="Veg Main Course">Veg Main Course</option>
                                <option value="Non-Veg Main Course">Non-Veg Main Course</option>
                                <option value="Rice Dishes">Rice Dishes</option>
                                <option value="Breads">Breads (Roti/Naan)</option>
                                <option value="Desserts">Desserts & Sweets</option>
                                <option value="Snacks">Snacks</option>
                                <option value="Dairy">Dairy Products</option>
                                <option value="Fruits">Fruits</option>
                                <option value="Vegetables">Vegetables</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Quantity</label>
                            <select id="quantityUnit" class="form-control" style="margin-bottom: 5px;">
                                <option value="grams">Grams (g)</option>
                                <option value="kilograms">Kilograms (kg)</option>
                                <option value="pieces">Pieces</option>
                                <option value="plates">Plates</option>
                                <option value="liters">Liters (L)</option>
                            </select>
                            <input type="number" id="foodQuantity" class="form-control" placeholder="Enter quantity" min="0.1" step="0.1" required>
                        </div>
                    </div>
                    
                    <div class="input-group">
                        <div class="form-group">
                            <label class="form-label">Cost (â‚¹)</label>
                            <input type="number" id="foodCost" class="form-control" placeholder="Cost in rupees" min="0" step="1" required>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Food Prepared</label>
                            <input type="number" id="foodPrepared" class="form-control" placeholder="Total prepared" min="1" step="0.1" required>
                        </div>
                    </div>
                    
                    <div class="input-group">
                        <div class="form-group">
                            <label class="form-label">Food Consumed</label>
                            <input type="number" id="foodConsumed" class="form-control" placeholder="Total consumed" min="0" step="0.1" required>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Food Wasted</label>
                            <input type="number" id="foodWasted" class="form-control" placeholder="Total wasted" min="0" step="0.1" required>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Date</label>
                        <input type="date" id="foodDate" class="form-control" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Meal Type</label>
                        <select id="mealType" class="form-control">
                            <option value="">Select Meal</option>
                            <option value="Breakfast">Breakfast</option>
                            <option value="Lunch">Lunch</option>
                            <option value="Dinner">Dinner</option>
                            <option value="Snacks">Snacks</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Notes (Optional)</label>
                        <textarea id="foodNotes" class="form-control" rows="3" placeholder="Any additional notes about this food item..."></textarea>
                    </div>
                    
                    <div class="form-group">
                        <button type="submit" class="btn btn-primary btn-full">
                            <i class="fas fa-plus"></i> Add Entry
                        </button>
                    </div>
                </form>
            </div>
            
            <!-- Recent Entries -->
            <div class="card">
                <h2 class="card-title"><i class="fas fa-history"></i> Recent Entries</h2>
                <div class="data-table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Food Item</th>
                                <th>Prepared</th>
                                <th>Consumed</th>
                                <th>Wasted</th>
                                <th>Cost</th>
                                <th>Date</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="recentEntries">
                            <!-- Entries will be added here by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Analytics Dashboard Screen -->
        <div id="dashboard-screen" class="screen">
            <div class="card">
                <h2 class="card-title"><i class="fas fa-chart-bar"></i> Analytics Dashboard</h2>
                
                <!-- Summary Stats -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value" id="totalWasted">0 kg</div>
                        <div class="stat-label">Total Food Wasted</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value rupee" id="totalLost">â‚¹0</div>
                        <div class="stat-label">Money Lost</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="wastePercent">0%</div>
                        <div class="stat-label">Waste Percentage</div>
                    </div>
                </div>
                
                <!-- Monthly Savings -->
                <div class="card" style="background: #FFF8E1; border-color: #FFECB3;">
                    <h3 style="color: #F57C00; margin-bottom: 1rem;">
                        <i class="fas fa-rupee-sign"></i> Monthly Potential Savings
                    </h3>
                    <div style="text-align: center;">
                        <div class="stat-value rupee" id="monthlySavings" style="color: #F57C00; font-size: 2.5rem;">â‚¹0</div>
                        <p style="color: var(--text-light);">You could save this much per month by reducing waste</p>
                    </div>
                </div>
                
                <!-- Waste Trend Chart -->
                <div style="margin: 2rem 0;">
                    <h3 style="margin-bottom: 1rem; color: var(--text-dark);">Waste Trend (Last 7 Days)</h3>
                    <div style="background: #f8f9fa; padding: 1rem; border-radius: 10px;">
                        <canvas id="wasteChart" height="200"></canvas>
                    </div>
                </div>
                
                <!-- Food Type Analysis -->
                <div style="margin: 2rem 0;">
                    <h3 style="margin-bottom: 1rem; color: var(--text-dark);">Waste by Food Type</h3>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Food Type</th>
                                <th>Quantity Wasted</th>
                                <th>Money Lost</th>
                                <th>Percentage</th>
                            </tr>
                        </thead>
                        <tbody id="foodTypeAnalysis">
                            
                        </tbody>
                    </table>
                </div>
                
                
                <div class="card" style="background: #E8F5E9; border-color: #C8E6C9; margin-top: 2rem;">
                    <h3 style="color: var(--primary-green); margin-bottom: 1rem;">
                        <i class="fas fa-lightbulb"></i> AI Recommendations
                    </h3>
                    <div id="aiRecommendations">
                        <p>Start adding food entries to get personalized recommendations to reduce waste.</p>
                    </div>
                    <button class="btn btn-secondary" style="margin-top: 1rem;" onclick="generateAIRecommendations()">
                        <i class="fas fa-robot"></i> Get AI Suggestions
                    </button>
                </div>
                
                
                <div class="card" style="margin-top: 2rem; text-align: center;">
                    <h3 style="color: var(--primary-green); margin-bottom: 1rem;">
                        <i class="fas fa-download"></i> Export Data
                    </h3>
                    <p style="color: var(--text-light); margin-bottom: 1rem;">Download your food waste data for analysis</p>
                    <div style="display: flex; gap: 10px; justify-content: center;">
                        <button class="btn btn-primary" onclick="exportData('csv')">
                            <i class="fas fa-file-csv"></i> Export as CSV
                        </button>
                        <button class="btn btn-secondary" onclick="exportData('pdf')">
                            <i class="fas fa-file-pdf"></i> Export as PDF
                        </button>
                    </div>
                </div>
            </div>
        </div>

       
        <div id="registerModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title">Create Account</h3>
                    <button class="close-modal" onclick="closeModal('registerModal')">&times;</button>
                </div>
                <form id="registerForm">
                    <div class="form-group">
                        <label class="form-label">Full Name</label>
                        <input type="text" id="registerName" class="form-control" placeholder="Enter your full name" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Email Address</label>
                        <input type="email" id="registerEmail" class="form-control" placeholder="Enter your email" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Mobile Number</label>
                        <input type="tel" id="registerMobile" class="form-control" placeholder="Enter your mobile number" pattern="[0-9]{10}">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Password</label>
                        <input type="password" id="registerPassword" class="form-control" placeholder="Create a password" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Confirm Password</label>
                        <input type="password" id="registerConfirmPassword" class="form-control" placeholder="Confirm your password" required>
                    </div>
                    
                    <div class="form-group">
                        <button type="submit" class="btn btn-primary btn-full">
                            <i class="fas fa-user-plus"></i> Register
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <div id="successModal" class="modal">
            <div class="modal-content" style="text-align: center;">
                <div style="width: 80px; height: 80px; background: #E8F5E9; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 1.5rem;">
                    <i class="fas fa-check" style="color: var(--primary-green); font-size: 2.5rem;"></i>
                </div>
                <h3 style="color: var(--primary-green); margin-bottom: 1rem;" id="successTitle">Success!</h3>
                <p id="successMessage">Operation completed successfully.</p>
                <button class="btn btn-primary" style="margin-top: 1.5rem;" onclick="closeModal('successModal')">
                    Continue
                </button>
            </div>
        </div>

       
    </div>

    
    <script>
        
        let currentUser = null;
        let foodEntries = [];
        let wasteChartInstance = null;

     
        const CURRENCY_SYMBOL = 'â‚¹';
        const COST_PER_KG = 150; 

        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
            loadSampleData();
            updateDashboard();
            setupEventListeners();
        });

        function initializeApp() {
           
            document.getElementById('foodDate').valueAsDate = new Date();
            
           
            const savedUser = localStorage.getItem('foodWasteUser');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                showScreen('dashboard-screen');
                updateNav();
            }
            
            
            const savedEntries = localStorage.getItem('foodEntries');
            if (savedEntries) {
                foodEntries = JSON.parse(savedEntries);
                updateRecentEntries();
            }
        }

        function setupEventListeners() {
           
            document.getElementById('loginForm').addEventListener('submit', function(e) {
                e.preventDefault();
                handleLogin();
            });
            
            
            document.getElementById('registerForm').addEventListener('submit', function(e) {
                e.preventDefault();
                handleRegister();
            });
            
           
            document.getElementById('foodEntryForm').addEventListener('submit', function(e) {
                e.preventDefault();
                addFoodEntry();
            });
            
            document.getElementById('foodPrepared').addEventListener('input', calculateWaste);
            document.getElementById('foodConsumed').addEventListener('input', calculateWaste);
        }

       
        function showScreen(screenId) {
          
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            
          
            document.getElementById(screenId).classList.add('active');
            
           
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
        
            const activeBtn = Array.from(document.querySelectorAll('.nav-btn')).find(btn => 
                btn.getAttribute('onclick')?.includes(screenId)
            );
            if (activeBtn) {
                activeBtn.classList.add('active');
            }
            
          
            if (screenId === 'dashboard-screen') {
                updateDashboard();
            }
        }

        function updateNav() {
            
            if (currentUser) {
                document.querySelectorAll('.nav-btn').forEach(btn => {
                    btn.style.display = 'flex';
                });
                document.querySelector('.nav-btn[onclick*="login-screen"]').innerHTML = 
                    '<i class="fas fa-user-circle"></i> ' + currentUser.name;
            }
        }

        function handleLogin() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            
            if (!email || !password) {
                showError('Please enter both email and password');
                return;
            }
           
            currentUser = {
                email: email,
                name: email.split('@')[0],
                type: 'individual',
                location: 'India'
            };
            
            localStorage.setItem('foodWasteUser', JSON.stringify(currentUser));
            
            updateNav();
            showScreen('dashboard-screen');
            
            
            showSuccess('Login Successful', 'Welcome to Food Waste Tracker!');
            
           
            logEvent('login', 'email_password');
        }

        function handleRegister() {
            const name = document.getElementById('registerName').value;
            const email = document.getElementById('registerEmail').value;
            const mobile = document.getElementById('registerMobile').value;
            const password = document.getElementById('registerPassword').value;
            const confirmPassword = document.getElementById('registerConfirmPassword').value;
            
           
            if (!name || !email || !password || !confirmPassword) {
                showError('Please fill all required fields');
                return;
            }
            
            if (password !== confirmPassword) {
                showError('Passwords do not match');
                return;
            }
            
         
            currentUser = {
                name: name,
                email: email,
                mobile: mobile,
                type: 'individual',
                location: 'India',
                createdAt: new Date().toISOString()
            };
            
           
            localStorage.setItem('foodWasteUser', JSON.stringify(currentUser));
            
            
            closeModal('registerModal');
            showSuccess('Registration Successful', 'Your account has been created!');
            showScreen('dashboard-screen');
            updateNav();
            
            
            logEvent('sign_up', 'email');
        }

        function showRegisterModal() {
            document.getElementById('registerModal').style.display = 'flex';
        }

        function logout() {
            currentUser = null;
            localStorage.removeItem('foodWasteUser');
            showScreen('login-screen');
            updateNav();
            showSuccess('Logged Out', 'You have been successfully logged out.');
        }

        
        function calculateWaste() {
            const prepared = parseFloat(document.getElementById('foodPrepared').value) || 0;
            const consumed = parseFloat(document.getElementById('foodConsumed').value) || 0;
            const wasted = prepared - consumed;
            
            if (wasted >= 0) {
                document.getElementById('foodWasted').value = wasted.toFixed(1);
            }
        }

        function addFoodEntry() {
            if (!currentUser) {
                showError('Please login first');
                showScreen('login-screen');
                return;
            }
            
            const foodName = document.getElementById('foodName').value;
            const foodType = document.getElementById('foodType').value;
            const quantity = parseFloat(document.getElementById('foodQuantity').value) || 0;
            const quantityUnit = document.getElementById('quantityUnit').value;
            const cost = parseFloat(document.getElementById('foodCost').value) || 0;
            const prepared = parseFloat(document.getElementById('foodPrepared').value) || 0;
            const consumed = parseFloat(document.getElementById('foodConsumed').value) || 0;
            const wasted = parseFloat(document.getElementById('foodWasted').value) || 0;
            const date = document.getElementById('foodDate').value;
            const mealType = document.getElementById('mealType').value;
            const notes = document.getElementById('foodNotes').value;
            
           
            if (wasted < 0) {
                showError('Wasted amount cannot be negative');
                return;
            }
            
            if (wasted > prepared) {
                showError('Wasted amount cannot exceed prepared amount');
                return;
            }
            
           
            const costPerUnit = prepared > 0 ? (cost / prepared) : 0;
            const moneyLost = wasted * costPerUnit;
            
            
            const entry = {
                id: Date.now(),
                userId: currentUser.email,
                foodName: foodName,
                foodType: foodType,
                quantity: quantity,
                quantityUnit: quantityUnit,
                cost: cost,
                prepared: prepared,
                consumed: consumed,
                wasted: wasted,
                moneyLost: moneyLost,
                date: date,
                mealType: mealType,
                notes: notes,
                timestamp: new Date().toISOString(),
                currency: 'INR'
            };
            
            
            foodEntries.push(entry);
            
           
            localStorage.setItem('foodEntries', JSON.stringify(foodEntries));
            
          
            updateRecentEntries();
            updateDashboard();
            
            
            document.getElementById('foodEntryForm').reset();
            document.getElementById('foodDate').valueAsDate = new Date();
            document.getElementById('quantityUnit').value = 'grams';
            
            
            showSuccess('Entry Added', 'Food entry has been saved successfully!');
            
            
            logEvent('food_entry_added', foodType);
        }

        function updateRecentEntries() {
            const container = document.getElementById('recentEntries');
            const recent = foodEntries.slice(-10).reverse(); // Show last 10 entries
            
            if (recent.length === 0) {
                container.innerHTML = `
                    <tr>
                        <td colspan="7" style="text-align: center; padding: 2rem; color: var(--text-light);">
                            No entries yet. Add your first food entry!
                        </td>
                    </tr>
                `;
                return;
            }
            
            let html = '';
            recent.forEach(entry => {
                const date = new Date(entry.date).toLocaleDateString('en-IN');
                const wastePercentage = entry.prepared > 0 ? (entry.wasted / entry.prepared * 100).toFixed(1) : 0;
                const foodTypeClass = entry.foodType.includes('Non-Veg') ? 'non-veg' : 
                                     entry.foodType.includes('Veg') ? 'veg' : 
                                     entry.foodType.includes('Dessert') || entry.foodType.includes('Sweets') ? 'sweets' : 'snacks';
                
                html += `
                    <tr>
                        <td>
                            <strong>${entry.foodName}</strong><br>
                            <span class="food-category-tag ${foodTypeClass}">${entry.foodType}</span>
                        </td>
                        <td>${entry.prepared.toFixed(1)}</td>
                        <td>${entry.consumed.toFixed(1)}</td>
                        <td><span style="color: ${entry.wasted > 0 ? '#F44336' : '#4CAF50'}">${entry.wasted.toFixed(1)} (${wastePercentage}%)</span></td>
                        <td><span class="rupee">${CURRENCY_SYMBOL}${entry.cost.toFixed(0)}</span></td>
                        <td>${date}</td>
                        <td>
                            <button onclick="deleteEntry(${entry.id})" style="background: #F44336; color: white; border: none; padding: 5px 10px; border-radius: 4px; cursor: pointer;">
                                <i class="fas fa-trash"></i>
                            </button>
                        </td>
                    </tr>
                `;
            });
            
            container.innerHTML = html;
        }

        function deleteEntry(entryId) {
            if (confirm('Are you sure you want to delete this entry?')) {
                foodEntries = foodEntries.filter(entry => entry.id !== entryId);
                localStorage.setItem('foodEntries', JSON.stringify(foodEntries));
                updateRecentEntries();
                updateDashboard();
                showSuccess('Entry Deleted', 'Food entry has been removed.');
            }
        }

        function updateDashboard() {
            if (foodEntries.length === 0) {
                resetDashboard();
                return;
            }
            
            
            const totalWasted = foodEntries.reduce((sum, entry) => sum + entry.wasted, 0);
            const totalPrepared = foodEntries.reduce((sum, entry) => sum + entry.prepared, 0);
            const totalMoneyLost = foodEntries.reduce((sum, entry) => sum + entry.moneyLost, 0);
            
        
            const wastePercentage = totalPrepared > 0 ? (totalWasted / totalPrepared * 100) : 0;
            
           
            const daysTracked = new Set(foodEntries.map(e => e.date)).size;
            const dailyAvgLoss = daysTracked > 0 ? totalMoneyLost / daysTracked : 0;
            const monthlySavings = dailyAvgLoss * 30;
            
        
            document.getElementById('totalWasted').textContent = formatWeight(totalWasted);
            document.getElementById('totalLost').textContent = CURRENCY_SYMBOL + totalMoneyLost.toFixed(0);
            document.getElementById('wastePercent').textContent = wastePercentage.toFixed(1) + '%';
            document.getElementById('monthlySavings').textContent = CURRENCY_SYMBOL + monthlySavings.toFixed(0);
            
            
            updateWasteChart();
            
         
            updateFoodTypeAnalysis();
        }

        function formatWeight(weight) {
            if (weight >= 1000) {
                return (weight / 1000).toFixed(1) + ' kg';
            }
            return weight.toFixed(0) + ' g';
        }

        function resetDashboard() {
            document.getElementById('totalWasted').textContent = '0 g';
            document.getElementById('totalLost').textContent = CURRENCY_SYMBOL + '0';
            document.getElementById('wastePercent').textContent = '0%';
            document.getElementById('monthlySavings').textContent = CURRENCY_SYMBOL + '0';
            
            document.getElementById('foodTypeAnalysis').innerHTML = `
                <tr>
                    <td colspan="4" style="text-align: center; padding: 2rem; color: var(--text-light);">
                        No data available. Add food entries to see analysis.
                    </td>
                </tr>
            `;
        }

        function updateWasteChart() {
            const ctx = document.getElementById('wasteChart').getContext('2d');
            
            
            const last7Days = getLast7Days();
            const wasteByDay = last7Days.map(date => {
                const dayEntries = foodEntries.filter(entry => 
                    new Date(entry.date).toDateString() === date.toDateString()
                );
                return dayEntries.reduce((sum, entry) => sum + entry.wasted, 0);
            });
            
            // Destroy previous chart if exists
            if (wasteChartInstance) {
                wasteChartInstance.destroy();
            }
            
            
            wasteChartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: last7Days.map(date => 
                        date.toLocaleDateString('en-IN', { weekday: 'short', day: 'numeric', month: 'short' })
                    ),
                    datasets: [{
                        label: 'Food Waste (grams)',
                        data: wasteByDay,
                        borderColor: '#F44336',
                        backgroundColor: 'rgba(244, 67, 54, 0.1)',
                        borderWidth: 2,
                        tension: 0.3,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(0, 0, 0, 0.05)'
                            },
                            title: {
                                display: true,
                                text: 'Grams Wasted'
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            }
                        }
                    }
                }
            });
        }

        function updateFoodTypeAnalysis() {
            const container = document.getElementById('foodTypeAnalysis');
            
          
            const typeMap = {};
            foodEntries.forEach(entry => {
                if (!typeMap[entry.foodType]) {
                    typeMap[entry.foodType] = {
                        waste: 0,
                        moneyLost: 0
                    };
                }
                typeMap[entry.foodType].waste += entry.wasted;
                typeMap[entry.foodType].moneyLost += entry.moneyLost;
            });
            
            const totalWaste = Object.values(typeMap).reduce((a, b) => a + b.waste, 0);
            
            let html = '';
            Object.entries(typeMap).forEach(([type, data]) => {
                const percentage = totalWaste > 0 ? (data.waste / totalWaste * 100) : 0;
                html += `
                    <tr>
                        <td><span style="color: ${getTypeColor(type)}; font-weight: 600;">${type}</span></td>
                        <td>${formatWeight(data.waste)}</td>
                        <td><span class="rupee">${CURRENCY_SYMBOL}${data.moneyLost.toFixed(0)}</span></td>
                        <td>
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <div style="flex: 1; background: #E0E0E0; height: 8px; border-radius: 4px;">
                                    <div style="width: ${percentage}%; background: ${getTypeColor(type)}; height: 100%; border-radius: 4px;"></div>
                                </div>
                                <span>${percentage.toFixed(1)}%</span>
                            </div>
                        </td>
                    </tr>
                `;
            });
            
            container.innerHTML = html || `
                <tr>
                    <td colspan="4" style="text-align: center; padding: 2rem; color: var(--text-light);">
                        No waste data available.
                    </td>
                </tr>
            `;
        }

        function getTypeColor(type) {
            const colors = {
                'Veg Main Course': '#4CAF50',
                'Non-Veg Main Course': '#F44336',
                'Rice Dishes': '#2196F3',
                'Breads': '#FF9800',
                'Desserts': '#9C27B0',
                'Snacks': '#FF5722',
                'Dairy': '#00BCD4',
                'Fruits': '#FF9800',
                'Vegetables': '#8BC34A'
            };
            return colors[type] || '#9E9E9E';
        }

        function getLast7Days() {
            const days = [];
            for (let i = 6; i >= 0; i--) {
                const date = new Date();
                date.setDate(date.getDate() - i);
                days.push(date);
            }
            return days;
        }

        
        function generateAIRecommendations() {
            if (foodEntries.length === 0) {
                document.getElementById('aiRecommendations').innerHTML = `
                    <p>Start adding food entries to get personalized recommendations to reduce waste.</p>
                `;
                return;
            }
            
            
            const totalWasted = foodEntries.reduce((sum, entry) => sum + entry.wasted, 0);
            const totalPrepared = foodEntries.reduce((sum, entry) => sum + entry.prepared, 0);
            const totalMoneyLost = foodEntries.reduce((sum, entry) => sum + entry.moneyLost, 0);
            const wastePercentage = totalPrepared > 0 ? (totalWasted / totalPrepared * 100) : 0;
            
           
            const typeMap = {};
            foodEntries.forEach(entry => {
                typeMap[entry.foodType] = (typeMap[entry.foodType] || 0) + entry.wasted;
            });
            
            const topType = Object.entries(typeMap).reduce((a, b) => 
                a[1] > b[1] ? a : b
            )[0];
            
            
            let recommendations = [];
            
            if (wastePercentage > 20) {
                recommendations.push(`Your waste rate is ${wastePercentage.toFixed(1)}%. Try preparing smaller portions typical in Indian thali system.`);
            }
            
            if (topType) {
                recommendations.push(`You waste ${typeMap[topType].toFixed(0)}g of ${topType} most often. Consider adjusting your ${topType} recipes.`);
            }
            
            if (totalMoneyLost > 500) {
                recommendations.push(`You're losing ${CURRENCY_SYMBOL}${totalMoneyLost.toFixed(0)} monthly. Plan weekly meals like traditional Indian meal planning to save money.`);
            }
            
          
            recommendations.push("Store Indian breads (rotis) properly - freeze what you won't eat in 2 days.");
            recommendations.push("Use leftover dal and sabji to make paratha stuffing the next day.");
            recommendations.push("Turn overripe fruits into Indian shakes or desserts like fruit raita.");
            recommendations.push("Plan your weekly khana (meals) to minimize vegetable waste.");
            
            if (recommendations.length > 4) {
                recommendations = recommendations.slice(0, 4);
            }
            
           
            let html = '<div style="padding: 10px;">';
            recommendations.forEach((rec, index) => {
                html += `
                    <div style="display: flex; align-items: flex-start; gap: 10px; margin-bottom: 15px; padding: 10px; background: rgba(255, 255, 255, 0.5); border-radius: 8px;">
                        <div style="background: ${getTypeColor(topType)}; color: white; width: 25px; height: 25px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 0.8rem; flex-shrink: 0;">
                            ${index + 1}
                        </div>
                        <div style="flex: 1;">${rec}</div>
                    </div>
                `;
            });
            html += '</div>';
            
            document.getElementById('aiRecommendations').innerHTML = html;
            
          
            logEvent('ai_recommendations_generated', foodEntries.length);
        }

        
        function exportData(format) {
            if (foodEntries.length === 0) {
                showError('No data to export');
                return;
            }
            
            if (format === 'csv') {
                exportToCSV();
            } else if (format === 'pdf') {
                exportToPDF();
            }
        }

        function exportToCSV() {
            
            let csvContent = "Food Name,Type,Prepared(g),Consumed(g),Wasted(g),Cost(â‚¹),Money Lost(â‚¹),Date,Meal Type\n";
            
            foodEntries.forEach(entry => {
                const row = [
                    `"${entry.foodName}"`,
                    `"${entry.foodType}"`,
                    entry.prepared.toFixed(1),
                    entry.consumed.toFixed(1),
                    entry.wasted.toFixed(1),
                    entry.cost.toFixed(0),
                    entry.moneyLost.toFixed(0),
                    `"${entry.date}"`,
                    `"${entry.mealType || ''}"`
                ].join(',');
                csvContent += row + '\n';
            });
            
            
            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `food_waste_data_${new Date().toISOString().split('T')[0]}.csv`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            
            showSuccess('Data Exported', 'CSV file downloaded successfully!');
        }

        function exportToPDF() {
            
            showSuccess('PDF Export', 'PDF generation would require additional libraries. For now, please use CSV export.');
        }

        
        function getRandomInt(min, max) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }

        function showError(message) {
            alert('Error: ' + message);
        }

        function showSuccess(title, message) {
            document.getElementById('successTitle').textContent = title;
            document.getElementById('successMessage').textContent = message;
            document.getElementById('successModal').style.display = 'flex';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        function logEvent(eventName, eventValue) {
            
            console.log(`[Analytics] ${eventName}: ${eventValue}`);
        }

        
        function loadSampleData() {
            
            if (foodEntries.length > 0) return;
            
           
            const sampleEntries = [
                {
                    id: 1,
                    userId: 'demo@example.com',
                    foodName: 'Vegetable Biryani',
                    foodType: 'Rice Dishes',
                    quantity: 1000,
                    quantityUnit: 'grams',
                    cost: 200,
                    prepared: 800,
                    consumed: 650,
                    wasted: 150,
                    moneyLost: 37.5,
                    date: new Date(Date.now() - 6 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],
                    mealType: 'Lunch',
                    notes: 'Leftover biryani'
                },
                {
                    id: 2,
                    userId: 'demo@example.com',
                    foodName: 'Chicken Curry',
                    foodType: 'Non-Veg Main Course',
                    quantity: 500,
                    quantityUnit: 'grams',
                    cost: 180,
                    prepared: 400,
                    consumed: 350,
                    wasted: 50,
                    moneyLost: 22.5,
                    date: new Date(Date.now() - 5 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],
                    mealType: 'Dinner'
                },
                {
                    id: 3,
                    userId: 'demo@example.com',
                    foodName: 'Roti',
                    foodType: 'Breads',
                    quantity: 8,
                    quantityUnit: 'pieces',
                    cost: 20,
                    prepared: 6,
                    consumed: 5,
                    wasted: 1,
                    moneyLost: 3.33,
                    date: new Date(Date.now() - 4 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],
                    mealType: 'Dinner'
                },
                {
                    id: 4,
                    userId: 'demo@example.com',
                    foodName: 'Paneer Butter Masala',
                    foodType: 'Veg Main Course',
                    quantity: 500,
                    quantityUnit: 'grams',
                    cost: 150,
                    prepared: 400,
                    consumed: 350,
                    wasted: 50,
                    moneyLost: 18.75,
                    date: new Date(Date.now() - 3 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],
                    mealType: 'Lunch'
                },
                {
                    id: 5,
                    userId: 'demo@example.com',
                    foodName: 'Gulab Jamun',
                    foodType: 'Desserts',
                    quantity: 6,
                    quantityUnit: 'pieces',
                    cost: 120,
                    prepared: 5,
                    consumed: 4,
                    wasted: 1,
                    moneyLost: 24,
                    date: new Date(Date.now() - 2 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],
                    mealType: 'Dinner',
                    notes: 'Festival sweets'
                }
            ];
            
            foodEntries = sampleEntries;
            localStorage.setItem('foodEntries', JSON.stringify(foodEntries));
            updateRecentEntries();
            updateDashboard();
        }

       
        function simulateFirebaseAuth(email, password) {
            
            return new Promise(resolve => {
                setTimeout(() => {
                    resolve({
                        user: {
                            uid: 'demo-user-' + Date.now(),
                            email: email,
                            displayName: email.split('@')[0]
                        }
                    });
                }, 1000);
            });
        }

        function simulateGeminiAI(prompt) {
            // Simulated Gemini AI response
            return new Promise(resolve => {
                setTimeout(() => {
                    const responses = [
                        "Based on your Indian food waste patterns, try meal planning like traditional Indian households to reduce waste by 30%.",
                        "Store Indian breads properly and use leftovers creatively in next day's meals.",
                        "Consider traditional Indian preservation methods like pickling or drying excess vegetables.",
                        "Plan your weekly khana (meals) to minimize vegetable and grain waste."
                    ];
                    resolve(responses[Math.floor(Math.random() * responses.length)]);
                }, 1500);
            });
        }

        
        window.addSampleData = loadSampleData;
        window.clearData = function() {
            if (confirm('Clear all data?')) {
                foodEntries = [];
                localStorage.removeItem('foodEntries');
                updateRecentEntries();
                updateDashboard();
                showSuccess('Data Cleared', 'All food entries have been removed.');
            }
        };

    </script>
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
</body>
</html>